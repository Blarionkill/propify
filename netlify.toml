# Netlify build configuration for Propify
#
# This file injects your Supabase credentials at build time using
# Netlify environment variables, so you never have to hardcode secrets.
#
# Setup:
#   1. In Netlify go to: Site settings → Environment variables
#   2. Add these two variables:
#        SUPABASE_URL      = https://xxxxxxxxxxxx.supabase.co
#        SUPABASE_ANON_KEY = eyJhbGci...
#   3. Trigger a new deploy — the sed command below will replace the
#      placeholders in propify_app.html automatically.
#
# If you prefer to edit propify_app.html directly (hardcode the values),
# you can delete this file and leave the build command empty in Netlify.

[build]
  command     = "sed -i 's|YOUR_SUPABASE_URL|'\"$SUPABASE_URL\"'|g' propify_app.html && sed -i 's|YOUR_SUPABASE_ANON_KEY|'\"$SUPABASE_ANON_KEY\"'|g' propify_app.html"
  publish     = "."

# Cache the app HTML for a short time; users always get a fresh copy
# but repeat visits within 60 s use the browser cache.
[[headers]]
  for = "/propify_app.html"
  [headers.values]
    Cache-Control = "public, max-age=60, stale-while-revalidate=300"

# Cache long-lived static assets (e.g. future JS/CSS files) aggressively.
[[headers]]
  for = "/*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
